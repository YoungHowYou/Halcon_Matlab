/***********************************************************
 * File generated by the HALCON-Compiler hcomp version 23.11
 * Usage: Interface to C++
 *
 * Software by: MVTec Software GmbH, www.mvtec.com
 ***********************************************************/


#ifndef __APPLE__
#  include "halconcpp/HalconCpp.h"
#  include "halconcpp/HalconAPI.h"
#else
#  ifndef HC_LARGE_IMAGES
#    include <HALCONCpp/HalconCpp.h>
#    include <HALCONCpp/HalconAPI.h>
#  else
#    include <HALCONCppxl/HalconCpp.h>
#    include <HALCONCppxl/HalconAPI.h>
#  endif
#endif

#include "HCPPHalcon_Matlab.h"

extern "C" HUserImport int HHalcon_MatlabGetOffset();

int offset = -1;

using namespace HalconCpp;

Hproc_handle PreCallUser(int proc_index_local)
{
  if (offset < 0)
  {
    /* First use of this extension package, query my offset */
    offset = HHalcon_MatlabGetOffset();
    if (offset < 0)
    {
      /* HALCON library not initialized (extension package as first usage). */
      /* Trigger initialization by touching system operator and try again. */
      Hproc_handle tmp = HalconAPI::PreCall(0);
      HalconAPI::PostCall(tmp);
      offset = HHalcon_MatlabGetOffset();
      if (offset < 0)
      {
        /* Ok, so something is *really* wrong */
        HOperatorException::Throw(proc_index_local,H_ERR_UEXTNI);
      }
    }
  }
  return HalconAPI::PreCall(offset + proc_index_local);
}




#ifdef MatlabEngGetmxArray
# error An existing macro name conflicts with MatlabEngGetmxArray
#endif
HUserExport void HalconCpp::MatlabEngGetmxArray(const HTuple& NAME, HTuple* M, HTuple* N, HTuple* VAL)
{
  Hproc_handle proc = PreCallUser(0);
  HalconAPI::StoreEnc(proc,0,NAME);
  HalconAPI::InitOutp(proc,0);
  HalconAPI::InitOutp(proc,1);
  HalconAPI::InitOutp(proc,2);
  HalconAPI::CallProcedure(proc);
  try
  {
    HalconAPI::Load(proc,0,M);
    HalconAPI::Load(proc,1,N);
    HalconAPI::Load(proc,2,VAL);
  }
  catch (...)
  {
    if (M)
      M->Clear();
    if (N)
      N->Clear();
    if (VAL)
      VAL->Clear();
    throw;
  }
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngSetmxArray
# error An existing macro name conflicts with MatlabEngSetmxArray
#endif
HUserExport void HalconCpp::MatlabEngSetmxArray(const HTuple& M, const HTuple& N, const HTuple& NAME, const HTuple& VAL)
{
  Hproc_handle proc = PreCallUser(1);
  HalconAPI::Store(proc,0,M);
  HalconAPI::Store(proc,1,N);
  HalconAPI::StoreEnc(proc,2,NAME);
  HalconAPI::Store(proc,3,VAL);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngSetVisible
# error An existing macro name conflicts with MatlabEngSetVisible
#endif
HUserExport void HalconCpp::MatlabEngSetVisible(const HTuple& Visible)
{
  Hproc_handle proc = PreCallUser(2);
  HalconAPI::Store(proc,0,Visible);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngOutputBuffer
# error An existing macro name conflicts with MatlabEngOutputBuffer
#endif
HUserExport void HalconCpp::MatlabEngOutputBuffer(const HTuple& BufferSize, HTuple* BufferMsg)
{
  Hproc_handle proc = PreCallUser(3);
  HalconAPI::Store(proc,0,BufferSize);
  HalconAPI::InitOutp(proc,0);
  HalconAPI::CallProcedure(proc);
  HalconAPI::LoadEnc(proc,0,BufferMsg);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngPutVariable
# error An existing macro name conflicts with MatlabEngPutVariable
#endif
HUserExport void HalconCpp::MatlabEngPutVariable(const HTuple& hv_DictHandle)
{
  Hproc_handle proc = PreCallUser(4);
  HalconAPI::Store(proc,0,hv_DictHandle);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngGetVariable
# error An existing macro name conflicts with MatlabEngGetVariable
#endif
HUserExport void HalconCpp::MatlabEngGetVariable(const HTuple& hv_DictHandle)
{
  Hproc_handle proc = PreCallUser(5);
  HalconAPI::Store(proc,0,hv_DictHandle);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngEvalString
# error An existing macro name conflicts with MatlabEngEvalString
#endif
HUserExport void HalconCpp::MatlabEngEvalString(const HTuple& matlabstring)
{
  Hproc_handle proc = PreCallUser(6);
  HalconAPI::StoreEnc(proc,0,matlabstring);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngClose
# error An existing macro name conflicts with MatlabEngClose
#endif
HUserExport void HalconCpp::MatlabEngClose()
{
  Hproc_handle proc = PreCallUser(7);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}

#ifdef MatlabEngOpen
# error An existing macro name conflicts with MatlabEngOpen
#endif
HUserExport void HalconCpp::MatlabEngOpen()
{
  Hproc_handle proc = PreCallUser(8);
  HalconAPI::CallProcedure(proc);
  HalconAPI::PostCall(proc);
}


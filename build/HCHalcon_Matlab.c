/***********************************************************
 * File generated by the HALCON-Compiler hcomp version 23.11
 * Usage: Interface to C
 *
 * Software by: MVTec Software GmbH, www.mvtec.com
 ***********************************************************/


#ifndef __APPLE__
#  include "HalconC.h"
#else
#  ifndef HC_LARGE_IMAGES
#    include <HALCONC/HalconC.h>
#  else
#    include <HALCONCxl/HalconC.h>
#  endif
#endif


extern HUserImport int HHalcon_MatlabGetOffset();

int offset = -1;

Herror HcPreCallUser(int proc_index_local, Hproc_handle *proc_handle)
{
  Hproc_handle ph;
  if (offset < 0)
  {
    /* First use of this extension package, query my offset */
    offset = HHalcon_MatlabGetOffset();
    if (offset < 0)
    {
      /* HALCON library not initialized (extension package as first usage). */
      /* Trigger initialization by touching system operator and try again. */
      HcPreCall(0,&ph);
      HcPostCall(ph,H_MSG_OK);
      offset = HHalcon_MatlabGetOffset();
      if (offset < 0)
      {
        /* Ok, so something is *really* wrong */
        *proc_handle = NULL;
        return H_ERR_UEXTNI;
      }
    }
  }
  return HcPreCall(offset + proc_index_local, proc_handle);
}

HUserExport Herror T_Matlab_engGetmxArray(const Htuple NAME, Htuple *M, Htuple *N, Htuple *VAL)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(0,&ph);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,0,&NAME);
  if (err == H_MSG_OK)
  {
    HcInitOCT(ph,0,M);
    HcInitOCT(ph,1,N);
    HcInitOCT(ph,2,VAL);
    err = HcCall(ph);
  }
  err = HcStoreOCT(ph,0,M,err);
  err = HcStoreOCT(ph,1,N,err);
  err = HcStoreOCT(ph,2,VAL,err);
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engSetmxArray(const Htuple M, const Htuple N, const Htuple NAME, const Htuple VAL)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(1,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&M);
  if (err == H_MSG_OK) err = HcStoreICT(ph,1,&N);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,2,&NAME);
  if (err == H_MSG_OK) err = HcStoreICT(ph,3,&VAL);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engSetVisible(const Htuple Visible)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(2,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&Visible);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engOutputBuffer(const Htuple BufferSize, Htuple *BufferMsg)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(3,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&BufferSize);
  if (err == H_MSG_OK)
  {
    HcInitOCT(ph,0,BufferMsg);
    err = HcCall(ph);
  }
  err = HcStoreOCTEnc(ph,0,BufferMsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engPutVariable(const Htuple hv_DictHandle)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(4,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&hv_DictHandle);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engGetVariable(const Htuple hv_DictHandle)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(5,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&hv_DictHandle);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engEvalString(const Htuple matlabstring)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(6,&ph);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,0,&matlabstring);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engClose(void)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(7,&ph);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_Matlab_engOpen(void)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(8,&ph);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engSetVisible(Hlong Visible)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(2,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,Visible);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engOutputBuffer(Hlong BufferSize, char *BufferMsg)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(3,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,BufferSize);
  if (err == H_MSG_OK)
  {
    HcInitOCS(ph,0);
    err = HcCall(ph);
  }
  err = HcStoreOCSEnc(ph,0,BufferMsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engPutVariable(Hlong hv_DictHandle)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(4,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,hv_DictHandle);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engGetVariable(Hlong hv_DictHandle)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(5,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,hv_DictHandle);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engEvalString(const char *matlabstring)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(6,&ph);
  if (err == H_MSG_OK) HcStoreICSEnc(ph,0,matlabstring);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engClose(void)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(7,&ph);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror Matlab_engOpen(void)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(8,&ph);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

